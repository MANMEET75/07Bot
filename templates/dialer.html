<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bharti</title>
	<link href="https://bp-wp-website-prod.s3.ap-south-1.amazonaws.com/wp-content/uploads/2023/09/BharatPe_logo_dark.png" rel="icon">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://code.responsivevoice.org/responsivevoice.js?key=UoZv1lZd"></script>    <!-- <link rel="stylesheet" href="/static/style.css"> -->
    <link href="/static/images/chatbot.png" rel="icon">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css?family=Exo" rel="stylesheet">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=auvTMQpf"></script>









</head>
<body>
    <style>
body{
	margin:0;
	color:#444;
	background:#ccc;
	font:300 18px/18px Roboto, sans-serif;
}
*,:after,:before{box-sizing:border-box}
.pull-left{float:left}
.pull-right{float:right}
.clearfix:after,.clearfix:before{content:'';display:table}
.clearfix:after{clear:both;display:block}

.dial-pad-wrap{
	width:590px;
	height:500px;
	overflow:hidden;
	position:relative;
	margin:50px auto 0;
	background:#ecf0f1;
	box-shadow:0 12px 15px 0 rgba(0,0,0,.24),0 17px 50px 0 rgba(0,0,0,.19);
}
.dial-pad-wrap .left-pan,
.dial-pad-wrap .dial-pad{
	padding:15px;
}
.dial-pad-wrap .left-pan{
	top:0;
	left:0;
	bottom:0;
	z-index:1;
	width:255px;
	position:absolute;
	background:#02b7ca;
	transition:width .4s ease-in-out 0s;
}
.dial-pad-wrap .left-pan.active{
	width:100%;
}
.dial-pad-wrap .left-pan .people .photo,
.dial-pad-wrap .left-pan .calling .photo{
	background:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUwIDUwIiBoZWlnaHQ9IjUwcHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MCA1MCIgd2lkdGg9IjUwcHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIvPjxwYXRoIGQ9Ik0zMC45MzMsMzIuNTI4Yy0wLjE0Ni0xLjYxMi0wLjA5LTIuNzM3LTAuMDktNC4yMWMwLjczLTAuMzgzLDIuMDM4LTIuODI1LDIuMjU5LTQuODg4YzAuNTc0LTAuMDQ3LDEuNDc5LTAuNjA3LDEuNzQ0LTIuODE4ICBjMC4xNDMtMS4xODctMC40MjUtMS44NTUtMC43NzEtMi4wNjVjMC45MzQtMi44MDksMi44NzQtMTEuNDk5LTMuNTg4LTEyLjM5N2MtMC42NjUtMS4xNjgtMi4zNjgtMS43NTktNC41ODEtMS43NTkgIGMtOC44NTQsMC4xNjMtOS45MjIsNi42ODYtNy45ODEsMTQuMTU2Yy0wLjM0NSwwLjIxLTAuOTEzLDAuODc4LTAuNzcxLDIuMDY1YzAuMjY2LDIuMjExLDEuMTcsMi43NzEsMS43NDQsMi44MTggIGMwLjIyLDIuMDYyLDEuNTgsNC41MDUsMi4zMTIsNC44ODhjMCwxLjQ3MywwLjA1NSwyLjU5OC0wLjA5MSw0LjIxQzE5LjM2NywzNy4yMzgsNy41NDYsMzUuOTE2LDcsNDVoMzggIEM0NC40NTUsMzUuOTE2LDMyLjY4NSwzNy4yMzgsMzAuOTMzLDMyLjUyOHoiLz48L3N2Zz4=) no-repeat center;
}
.dial-pad-wrap .left-pan .contacts .title{
	color:#eee;
	font-size:24px;
	font-weight:400;
	margin-top:15px;
	text-align:center;
	margin-bottom:15px;
	padding-bottom:10px;
	text-transform:uppercase;
	border-bottom:2px solid #eee;
}
.dial-pad-wrap .left-pan .people{
	padding:10px;
	display:none;
	cursor:default;
	background:#eee;
	margin-bottom:15px;
	box-shadow:0 4px 8px 0 rgba(0,0,0,.2),0 5px 8px 0 rgba(0,0,0,.19);
}
.dial-pad-wrap .left-pan .people .photo{
	width:50px;
	height:50px;
	overflow:hidden;
	border-radius:50%;
	margin-right:10px;
	border:2px solid #16a085;
}
.dial-pad-wrap .left-pan .people .photo img{
	width:100%;
	display:block;
}
.dial-pad-wrap .left-pan .people .info .name{
	margin-bottom:10px;
}
.dial-pad-wrap .left-pan .people .info .phone{
	font-size:14px;
	font-weight:500;
}
.dial-pad-wrap .left-pan .people .phone .highlight{
	color:#75c4b5;
}

.dial-pad-wrap .left-pan .calling{
	color:#eee;
	margin:auto;
	display:none;
	max-width:300px;
	text-align:center;
}
.dial-pad-wrap .left-pan .calling .title{
	font-size:28px;
	margin:20px 0;
}
.dial-pad-wrap .left-pan .calling .name,
.dial-pad-wrap .left-pan .calling .photo,
.dial-pad-wrap .left-pan .calling .action,
.dial-pad-wrap .left-pan .calling .number{
	margin:auto;
	margin-top:20px;
	margin-bottom:15px;
}
.dial-pad-wrap .left-pan .calling .photo{
	width:100px;
	height:100px;
	overflow:hidden;
	border:2px solid;
	border-radius:50%;
	box-shadow:0 8px 10px 0 rgba(0,0,0,.24),0 10px 50px 0 rgba(0,0,0,.19);
}
.dial-pad-wrap .left-pan .calling .photo img{
	width:100%;
	display:block;
}
.dial-pad-wrap .left-pan .calling .name{
	margin:30px 0;
	font-size:24px;
	font-weight:400;
}
.dial-pad-wrap .left-pan .calling .action{
	width:100%;
	display:table;
}
.dial-pad-wrap .left-pan .calling .action .lnk{
	width:25%;
	display:table-cell;
}
.dial-pad-wrap .left-pan .calling .btn{
	width:40px;
	height:40px;
	border:none;
	color:#419887;
	font-size:16px;
	border-radius:50%;
	animation-duration:1s;
}
.dial-pad-wrap .left-pan .calling .action .btn.active{
	color:#eee;
	background:#000;
}
.dial-pad-wrap .left-pan .calling .call-end{
	margin-top:30px;
}
.dial-pad-wrap .left-pan .calling .call-end .btn{
	width:200px;
	color:#eee;
	font-size:24px;
	border-radius:25px;
	background:#c0392b;
}
.loader {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #3498db;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    animation: spin 2s linear infinite;
    margin: 0 auto;
	padding-bottom: 40px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
.dial-pad-wrap .left-pan .calling .action .btn .fa-mic:before{
	content:'\f131';
}
.dial-pad-wrap .left-pan .calling .action .btn.active .fa-mic:before{
	content:'\f130';
}
.dial-pad-wrap .left-pan .calling .action .btn .fa-vol:before{
	content:'\f027';
}
.dial-pad-wrap .left-pan .calling .action .btn.active .fa-vol:before{
	content:'\f028';
}

.dial-pad-wrap .dial-pad{
	height:100%;
	padding:40px;
	margin-left:255px;
}
.dial-pad-wrap .dial-screen{
	height:50px;
	padding:0 15px;
	font-size:28px;
	font-weight:400;
	line-height:50px;
	text-align:right;
	margin-bottom:20px;
	background:#eef1f2;
	border:1px solid #e9eeef;
}
.dial-pad-wrap .dial-table{
	width:100%;
	display:table;
}
.dial-pad-wrap .dial-table .dial-table-row{
	display:table-row;
}
.dial-pad-wrap .dial-table .dial-table-col{
	cursor:default;
	width:33.333333%;
	text-align:center;
	display:table-cell;
	vertical-align:top;
}
.dial-pad-wrap .dial-table .dial-key-wrap{
	margin-bottom:20px;
	transition:background .3s ease-in-out 0s;
}
.dial-pad-wrap .dial-table .dial-table-col .dial-key{
	font-size:28px;
	font-weight:400;
	min-height:30px;
	line-height:30px;
}
.dial-pad-wrap .dial-table .no-sub-key .dial-key{
	min-height:48px;
	line-height:48px;
}
.dial-pad-wrap .dial-table .dial-sub-key{
	color:#aaa;
	font-size:14px;
	text-transform:uppercase;
}
.dial-pad-wrap .no-sub-key .dial-sub-key{
	display:none;
}
.dial-pad-wrap .dial-table .dial-key-wrap.active,
.dial-pad-wrap .dial-table .dial-key-wrap:hover{
	color:#eee;
	background:#02b7ca;
}
.dial-pad-wrap .dial-table .dial-key-wrap.active .dial-sub-key,
.dial-pad-wrap .dial-table .dial-key-wrap:hover .dial-sub-key{
	color:#eee;
}


    </style>
    <br>
    <br>
    <center>
		<a href="">
			
			<img src="../static/bharatpe-logo-removebg-preview.png" alt="">
		</a>
    </center>
    <br>
    
    <div class="dial-pad-wrap">
      <div class="left-pan">
        <!-- <div class="contacts">
          <div class="title">merchants</div>
          <div class="people clearfix">
            <div class="photo pull-left">
              <img src="http://s.gravatar.com/avatar/24a65a47147cddf5b270bc9f609ffa2a?s=128">
            </div>
            <div class="info pull-left">
              <div class="name">Mohan Khadka</div>
              <div class="phone"><span>+977</span><span class="number">0123456789</span></div>
            </div>
          </div>
          <div class="people clearfix">
            <div class="photo pull-left">
              <img src="http://s.gravatar.com/avatar/fdd39509d4ae5392e3bfa7c72e61c3a9?s=128">
            </div>
            <div class="info pull-left">
              <div class="name">Arjun Amgain</div>
              <div class="phone"><span>+977</span><span class="number">5320100325</span></div>
            </div>
          </div>
          <div class="people clearfix">
            <div class="photo pull-left">
              <img src="https://s3.amazonaws.com/uifaces/faces/twitter/rogie/128.jpg">
            </div>
            <div class="info pull-left">
              <div class="name">Jane Doe</div>
              <div class="phone"><span>+977</span><span class="number">0002453687</span></div>
            </div>
          </div>
          <div class="people clearfix">
            <div class="photo pull-left">
              <img src="https://s3.amazonaws.com/uifaces/faces/twitter/adhamdannaway/128.jpg">
            </div>
            <div class="info pull-left">
              <div class="name">John Doe</div>
              <div class="phone"><span>+977</span><span class="number">7703256581</span></div>
            </div>
          </div>
        </div> -->







		<div style="position: relative;top: 45%">
			<center><p id="userConfirmation" style="font-size: 20px;"></p></center>
		</div>

		<div class="loading" style="display: none;text-align: center;font-size: 25px;position: relative;top: 30%;">
			<div class="loader"></div>
			<br>
			<br>
			<br>
			<p class="message"></p>
			<!-- Other loading content if needed -->
		</div>

		<div class="response">
			<p class="response-text"></p>
		</div>

	









        <div class="calling">
          <div class="title fadeIn animated infinite">Calling</div>
          <div class="photo bounceInDown animated"></div>
          <div class="name rubberBand animated">Unknown</div>
          <div class="number"></div>
          <div class="action">
            <div class="lnk"><button class="btn fadeInLeftBig animated"><i class="fa fa-mic"></i></button></div>
            <div class="lnk"><button class="btn fadeInLeftBig animated"><i class="fa fa-vol"></i></button></div>
            <div class="lnk"><button class="btn fadeInRightBig animated"><i class="fa fa-camera"></i></button></div>
            <div class="lnk"><button class="btn fadeInRightBig animated"><i class="fa fa-video-camera"></i></button></div>
          </div>

		  
          <div class="call-end bounceInUp animated">
            <button class="btn"><i class="fa fa-phone"></i></button>
          </div>
        </div>
      </div>
      <div class="dial-pad">
        <div class="dial-screen" contenteditable="false"></div>
        <div class="dial-table">
          <div class="dial-table-row">
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="1">
                <div class="dial-key">1</div>
                <div class="dial-sub-key">&nbsp;</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="2">
                <div class="dial-key">2</div>
                <div class="dial-sub-key">abc</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="3">
                <div class="dial-key">3</div>
                <div class="dial-sub-key">def</div>
              </div>
            </div>
          </div>
          <div class="dial-table-row">
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="4">
                <div class="dial-key">4</div>
                <div class="dial-sub-key">ghi</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="5">
                <div class="dial-key">5</div>
                <div class="dial-sub-key">jkl</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="6">
                <div class="dial-key">6</div>
                <div class="dial-sub-key">mno</div>
              </div>
            </div>
          </div>
          <div class="dial-table-row">
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="7">
                <div class="dial-key">7</div>
                <div class="dial-sub-key">pqrs</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="8">
                <div class="dial-key">8</div>
                <div class="dial-sub-key">tuv</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="9">
                <div class="dial-key">9</div>
                <div class="dial-sub-key">wxyz</div>
              </div>
            </div>
          </div>
          <div class="dial-table-row">
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="*">
                <div class="dial-key">*</div>
                <div class="dial-sub-key">&nbsp;</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="0">
                <div class="dial-key">0</div>
                <div class="dial-sub-key">+</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="#">
                <div class="dial-key">#</div>
                <div class="dial-sub-key">&nbsp;</div>
              </div>
            </div>
          </div>
          <div class="dial-table-row no-sub-key">
            <div class="dial-table-col">
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="call">
                <div class="dial-key" id="dialer"><i class="fa fa-phone"></i></div>
                <div class="dial-sub-key">Call</div>
              </div>
            </div>
            <div class="dial-table-col">
              <div class="dial-key-wrap" data-key="back">
                <div class="dial-key"><i class="fa fa-long-arrow-left"></i></div>
                <div class="dial-sub-key">Back</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

	

    <script>
			const play_btn = document.querySelector('#dialer');
			let sound = new Audio("https://github.com/MANMEET75/MP3-PLAYER-USING-JAVASCRIPT/raw/main/1.mp3");
			play_btn.addEventListener('click', play);
			document.addEventListener('keypress', function(event) {
				if (event.key === 'Enter' || event.keyCode === 13) {
					play();
				}
			});

			function play() {
				sound.play();
				setTimeout(function() {
					sound.pause();
					sound.currentTime = 0;
				}, 2000); // 2000 milliseconds = 2 seconds
			}


		

		  




      $(function(){
  DialPad.init();
});
var DialPad={
	init:function(){
		this.filter();
		this.keypad();
		this.dialing();
		$("body,html,img").bind("contextmenu selectstart dragstart",function(){return false});
	},
	dialing:function(){
		$('.people').click(function(){
			DialPad.call($(this));
		});
		$('.action .btn').click(function(){
			$(this).toggleClass('active');
		});
		$('.call-end').click(function(){
			$('.left-pan').removeClass('active');
			$('.calling').fadeOut(100);
			$('.contacts').fadeIn(800);
			$('.calling .photo').html('');
			$('.calling .name').html('Unknown');
			$('.calling .number').html('');
		});
	},
	longClick:function(){
		var pressTimer
		$('.dial-key-wrap[data-key="back"]').mouseup(function(){
			clearTimeout(pressTimer)
		return false;
		}).mousedown(function(){
		pressTimer = window.setTimeout(function() {
			$('.dial-screen').text('');
		},1000)
		return false; 
		});
	},
	keypad:function(){
		$('.dial-key-wrap').on('click',function(){
			var key = $(this).data('key');
			var display = $('.dial-screen').text();
			switch(key){
				case 'back':
					DialPad.press($('.dial-key-wrap[data-key="back"]'));
					display = $('.dial-screen').text(display.substring(0,display.length - 1));
					DialPad.longClick();
					break;
				case 'call':
					DialPad.press($('.dial-key-wrap[data-key="call"]'));
					DialPad.call();
					break;
				case 0:
					DialPad.press($('.dial-key-wrap[data-key="0"]'));
					display = $('.dial-screen').text(display+'0');
					break;
				case 1:
					DialPad.press($('.dial-key-wrap[data-key="1"]'));
					display = $('.dial-screen').text(display+'1');
					break;
				case 2:
					DialPad.press($('.dial-key-wrap[data-key="2"]'));
					display = $('.dial-screen').text(display+'2');
					break;
				case 3:
					DialPad.press($('.dial-key-wrap[data-key="3"]'));
					display = $('.dial-screen').text(display+'3');
					break;
				case 4:
					DialPad.press($('.dial-key-wrap[data-key="4"]'));
					display = $('.dial-screen').text(display+'4');
					break;
				case 5:
					DialPad.press($('.dial-key-wrap[data-key="5"]'));
					display = $('.dial-screen').text(display+'5');
					break;
				case 6:
					DialPad.press($('.dial-key-wrap[data-key="6"]'));
					display = $('.dial-screen').text(display+'6');
					break;
				case 7:
					DialPad.press($('.dial-key-wrap[data-key="7"]'));
					display = $('.dial-screen').text(display+'7');
					break;
				case 8:
					DialPad.press($('.dial-key-wrap[data-key="8"]'));
					display = $('.dial-screen').text(display+'8');
					break;
				case 9:
					DialPad.press($('.dial-key-wrap[data-key="9"]'));
					display = $('.dial-screen').text(display+'9');
					break;
				case '*':
					DialPad.press($('.dial-key-wrap[data-key="*"]'));
					display = $('.dial-screen').text(display+'*');
					break;
				case '#':
					DialPad.press($('.dial-key-wrap[data-key="#"]'));
					display = $('.dial-screen').html(display+'#');
					break;
			}
			DialPad.filter();
		});




		$(document).keydown(function(e){
			var key = e.which;
			var screen = $('.dial-screen').text();
			
			switch(e.which){
				case 8:
					DialPad.press($('.dial-key-wrap[data-key="back"]'));
					screen = $('.dial-screen').text(screen.substring(0,screen.length - 1));
					break;
				case 13:
					DialPad.press($('.dial-key-wrap[data-key="call"]'));
					DialPad.call();
					break;
				case 96:
					DialPad.press($('.dial-key-wrap[data-key="0"]'));
					screen = $('.dial-screen').text(screen+'0');
					break;
				case 97:
					DialPad.press($('.dial-key-wrap[data-key="1"]'));
					screen = $('.dial-screen').text(screen+'1');
					break;
				case 98:
					DialPad.press($('.dial-key-wrap[data-key="2"]'));
					screen = $('.dial-screen').text(screen+'2');
					break;
				case 99:
					DialPad.press($('.dial-key-wrap[data-key="3"]'));
					screen = $('.dial-screen').text(screen+'3');
					break;
				case 100:
					DialPad.press($('.dial-key-wrap[data-key="4"]'));
					screen = $('.dial-screen').text(screen+'4');
					break;
				case 101:
					DialPad.press($('.dial-key-wrap[data-key="5"]'));
					screen = $('.dial-screen').text(screen+'5');
					break;
				case 102:
					DialPad.press($('.dial-key-wrap[data-key="6"]'));
					screen = $('.dial-screen').text(screen+'6');
					break;
				case 103:
					DialPad.press($('.dial-key-wrap[data-key="7"]'));
					screen = $('.dial-screen').text(screen+'7');
					break;
				case 104:
					DialPad.press($('.dial-key-wrap[data-key="8"]'));
					screen = $('.dial-screen').text(screen+'8');
					break;
				case 105:
					DialPad.press($('.dial-key-wrap[data-key="9"]'));
					screen = $('.dial-screen').text(screen+'9');
					break;
			}
			var array = [8,13,96,97,98,99,100,101,102,103,104,105];
			var prevent=true;
			for(var i=0;i<array.length;i++){
				if(key==array[i]){
					DialPad.filter();
					break;
				}
			}
			if(key==8){
				return false;
			}
		});
	},

	call:function(info){
	
    var num = $('.dial-screen').text().length;
    console.log(num);
    if(num > 0){
        var photo,name,number;
        $('.left-pan').addClass('active');
        $('.contacts').fadeOut(100);
        $('.calling').fadeIn(800);
        if(info){
            photo = info.find('img').attr('src')?'<img src="'+info.find('img').attr('src')+'">':null;
            name = info.find('.name').text()?info.find('.name').text():'Unknown';
            number = info.find('.phone').text();
            console.log(number);
            $('.calling .photo').html(photo);
            $('.calling .name').text(name);
            $('.calling .number').text(number);
        }else{
            number=$('.dial-screen').text();
            $('.calling .number').text(number);
            console.log(number);


		


            const formData = new FormData();
            formData.append('query', number);
			let newUserSelected = false;
			

			$.ajax({
				type: 'POST',
				url: '/get_response',
				data: formData,
				processData: false,
				contentType: false,
				success: function(data) {
					const timeString = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
					console.log(data['result']);

					if (data[0] === true) {
						// If get_response returns True, open the URL with mobile number and timestamp as parameters
						setTimeout(function() {
							var phoneNumber = (data[1]); // Encode mobile number to handle special characters
							var timestamp = (data[2]); // Encode timestamp to handle special characters
							var url = "http://127.0.0.1:8000/?phone=" + phoneNumber + "&timestamp=" + timestamp;
							window.open(url, "_self");

							$('#phoneNumber').val(phoneNumber);
						}, 6000); // 6000 milliseconds = 6 seconds
					}
				

					
					else if (data==="high-priority"){
						setTimeout(() => {
							$('#userConfirmation').html('<label>Most Valuable Customer : We will shortly callback.</label>');
						}, 8000);
					}
					else if (data[0] === "New User") {
						// If user has not selected a new number previously, show the option
						if (!newUserSelected) {
							// Delay displaying the text indicating phone number is not registered after 5 seconds
							setTimeout(function() {
								$('#userConfirmation').html('<p id="notRegisteredText">Your phone number is not registered.</p>');
								$('#notRegisteredText').fadeIn();

								// Delay hiding the text after 1 second
								setTimeout(function() {
									$('#notRegisteredText').fadeOut(function() {
										// Replace with user confirmation options after fading out
										$('#userConfirmation').html('<label>Do you want to continue with the same number?</label><br><button id="continueSameNumber" class="btn btn-dark" style="margin:2px;">Yes</button>&nbsp;<button id="chooseNewNumber" style="margin:2px;" class="btn btn-dark">No</button>');
										
										// Event handler for when the user clicks 'Yes' to continue with the same number
										$('#continueSameNumber').on('click', function() {
											// Open a new tab with the same number
											var phoneNumber = (data[1]);
											var timestamp = (data[2]);
											var url = "http://127.0.0.1:8000/?phone=" + phoneNumber + "&timestamp=" + timestamp;


											window.open(url, "_self");
										});

										// Event handler for when the user clicks 'No' to choose a new number
										$('#chooseNewNumber').on('click', function() {
											// Set the flag to indicate that user has selected a new number
											newUserSelected = true;
											
											// Redirect the user to the home page
											window.location.href = "http://127.0.0.1:8888/";
										});
									});
								}, 3000); // Delay hiding the text after 1 second
							}, 8000); // Delay displaying the text after 5 seconds
						} else {
							// If user has selected a new number previously, do not show the option
							// You can add any other logic here if needed
						}
					}
					
					




					setTimeout(() => {
						responsiveVoice.speak("Welcome, I'm here to assist you further. Please Wait","Hindi Female", {rate: 0.98, pitch: 0.75,volume: 1.25});
					}, 3000);
				},
				error: function(error) {
					console.error(error);
				}
			})

            // sendNumberToFlask(number);
        }
		setTimeout(function(){
			$('.call-end .btn').focus();
			$('.calling').fadeOut(2000, function() {
				$('.loading').fadeIn(500); // Fade in loading element
				$('.loading .message').text("Please Wait!"); // Set loading message
				setTimeout(function() {
					$('.loading').fadeOut(500, function() {
						// Fade out loading element after 2 seconds
						// window.location.href = "http://127.0.0.1:8000/"; // Replace "https://example.com" with the URL you want to open
					}); 
				}, 3000); // Wait for 3 seconds before fading out the loading element
			});
		}, 2000); // Wait for 2 seconds before focusing and hiding


    }
},
	filter:function(){
		var highlight = function(string){
		$('.people .number.match').each(function(){
			var matchStart = $(this).text().toLowerCase().indexOf('' + string.toLowerCase() + '');
			var matchEnd = matchStart + string.length - 1;
			var beforeMatch = $(this).text().slice(0, matchStart);
			var matchText = $(this).text().slice(matchStart, matchEnd + 1);
			var afterMatch = $(this).text().slice(matchEnd + 1);
			$(this).html(beforeMatch + '<span class="highlight">' + matchText + '</span>' + afterMatch);
		});
		};
		var showcontact =  function(){
			$('.people .number').each(function(){
				if($(this).css('display')=='inline'){
					$(this).parent().parent().parent().show();
				}else{
					$(this).parent().parent().parent().hide();
				}
			});
		};
		//var refine = function(){
			var _this = $('.dial-screen');
			if(_this.text()){
				$('.people .number').removeClass('match').hide().filter(function(){
					return $(this).text().toLowerCase().indexOf(_this.text().toLowerCase()) != -1;
				}).addClass('match').show();
				highlight(_this.text());
				$('.people').show();
				showcontact();
			}else{
				$('.people,.people .number').removeClass('match').hide();
			}
		//};
	},
	press:function(obj){
		var button = obj.addClass('active');
		setTimeout(function () {
			button.removeClass('active');
		}, 200);
	}
}

		
 

    </script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</body>
</html>